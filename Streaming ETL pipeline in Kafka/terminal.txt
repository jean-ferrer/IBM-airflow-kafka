1. Open the terminal and download Kafka.

wget https://archive.apache.org/dist/kafka/3.7.0/kafka_2.12-3.7.0.tgz


2. Extract Kafka from the zip file.

tar -xzf kafka_2.12-3.7.0.tgz


3. Change to the kafka_2.12-3.7.0 directory.

cd kafka_2.12-3.7.0


4. Generate a cluster UUID that will uniquely identify the Kafka cluster.

KAFKA_CLUSTER_ID="$(bin/kafka-storage.sh random-uuid)"


5. KRaft requires the log directories to be configured. Run the following command to configure the log directories passing the cluster id.

bin/kafka-storage.sh format -t $KAFKA_CLUSTER_ID -c config/kraft/server.properties


6. Now that KRaft is configured, you can start the Kafka server by running the following command.

bin/kafka-server-start.sh config/kraft/server.properties


7. In a new terminal, connect to the MySQL server. Make sure you use the password given to you when the MySQL server starts.

mysql --host=mysql --port=3306 --user=root --password=<replace_with_your_password>


8. Create a database named tolldata.

create database tolldata;


9. Create a table named livetolldata with the schema to store the data generated by the traffic simulator.

use tolldata;
create table livetolldata(timestamp datetime,vehicle_id int,vehicle_type char(15),toll_plaza_id smallint);


10. Disconnect from the MySQL server.

exit


11. Install the Python module kafka-python. This Python module will help you to communicate with kafka server. It can used to send and receive messages from Kafka.

pip3 install kafka-python


12. Install the Python module mysql-connector-python using the pip command.

pip3 install mysql-connector-python==8.0.31


13. Create a Kafka topic named 'toll'.

cd kafka_2.12-3.7.0/bin
./kafka-topics.sh --bootstrap-server localhost:9092 --create --topic toll --partitions 3 --replication-factor 1


14. Download the toll_traffic_generator.py from the url given below using wget.

wget https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/IBM-DB0250EN-SkillsNetwork/labs/Final%20Assignment/toll_traffic_generator.py


15. Open the toll_traffic_generator.py and set the topic to 'toll'.


16. Run the toll_traffic_generator.py.

python3 toll_traffic_generator.py


17. In a new terminal, download the streaming-data-reader.py from the URL below using wget.

wget https://cf-courses-data.s3.us.cloud-object-storage.appdomain.cloud/vVxmU5uatDowvAIKRZrFjg/streaming-data-reader.py


18. Open the streaming-data-reader.py and modify the following details so that the program can connect to your MySQL server: 'TOPIC', 'DATABASE', 'USERNAME', 'PASSWORD'.


19. Run the streaming-data-reader.py.

python3 streaming-data-reader.py


20. In a new terminal, connect to the MySQL database.

mysql --host=mysql --port=3306 --user=root --password=<replace_with_your_password>


21. List the last 10 rows in the table livetolldata.

USE tolldata;
SELECT * FROM livetolldata ORDER BY timestamp DESC LIMIT 10;
